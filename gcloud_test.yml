- name: Create an instance
  hosts: localhost
  gather_facts: no
  vars:
    gcp_project: iaac-237416
    gcp_cred_kind: serviceaccount
    gcp_compute_zone: europe-west6-b
    gcp_machine_type: e2-micro
    gcp_source_image: debian-10-buster-v20200805
    gcp_auth_kind: serviceaccount
    gcp_service_account_email: provision@iaac-237416.iam.gserviceaccount.com
    gcp_service_account_file: /home/adminfpi/secure/iaac-237416-1c777c9c8e68.json
    gcp_zone: "europe-west6-b"
    gcp_region: "europe-west"

  tasks:
   - name: create a disk
     gcp_compute_disk:
         name: 'iaac-disk-instance'
         size_gb: 10
         source_image: 'projects/ubuntu-os-cloud/global/images/family/ubuntu-1604-lts'
         zone: "{{ gcp_zone }}"
         project: "{{ gcp_project }}"
         auth_kind: "{{ gcp_cred_kind }}"
         service_account_file: "{{ gcp_service_account_file }}"
         scopes:
           - https://www.googleapis.com/auth/compute
         state: present
     register: disk
   - name: create a network
     gcp_compute_network:
         name: 'iaac-network'
         project: "{{ gcp_project }}"
         auth_kind: "{{ gcp_cred_kind }}"
         service_account_file: "{{ gcp_service_account_file }}"
         scopes:
           - https://www.googleapis.com/auth/compute
         state: present